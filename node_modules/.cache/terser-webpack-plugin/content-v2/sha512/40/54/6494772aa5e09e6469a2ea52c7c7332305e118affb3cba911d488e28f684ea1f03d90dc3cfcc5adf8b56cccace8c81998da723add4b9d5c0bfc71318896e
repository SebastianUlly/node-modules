{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{400:function(t,e,n){\"use strict\";n.d(e,\"f\",(function(){return p})),n.d(e,\"h\",(function(){return y})),n.d(e,\"e\",(function(){return m})),n.d(e,\"g\",(function(){return I})),n.d(e,\"b\",(function(){return O})),n.d(e,\"i\",(function(){return v})),n.d(e,\"j\",(function(){return b})),n.d(e,\"d\",(function(){return j})),n.d(e,\"a\",(function(){return g})),n.d(e,\"k\",(function(){return w})),n.d(e,\"c\",(function(){return C}));n(27),n(56),n(99),n(47),n(49),n(15),n(69),n(420),n(66),n(74),n(421),n(422),n(423),n(424),n(425),n(426),n(427),n(428),n(429),n(430),n(431),n(432),n(433),n(434),n(435),n(436),n(68);var r=n(402),i=n(35),o=n(34),a=n(29),c=n(16),l=n(19),u=n(532);function s(t){var e=function(){if(\"undefined\"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(\"function\"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Object(c.a)(t);if(e){var i=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(a.a)(this,n)}}function f(t,e){var n;if(\"undefined\"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if(\"string\"==typeof t)return d(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);\"Object\"===n&&t.constructor&&(n=t.constructor.name);if(\"Map\"===n||\"Set\"===n)return Array.from(t);if(\"Arguments\"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d(t,e)}(t))||e&&t&&\"number\"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}var o,a=!0,c=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){c=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(c)throw o}}}}function d(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var p=function t(e,n,r){Object(l.a)(this,t);var i,o=f(e);try{for(o.s();!(i=o.n()).done;){var a,c=i.value,u=f(n);try{for(u.s();!(a=u.n()).done;){var s=a.value;if(c.fileId===s.fileId){c.label=s.label,c.schemaId=s.schemaId;var d,p=f(r);try{for(p.s();!(d=p.n()).done;){var h=d.value;s.schemaId===h.id&&(c.isLeaf=h.metadata.isLeaf)}}catch(t){p.e(t)}finally{p.f()}}}}catch(t){u.e(t)}finally{u.f()}}}catch(t){o.e(t)}finally{o.f()}return e},h=function t(e){Object(l.a)(this,t),this.directoryCopy=JSON.parse(JSON.stringify(e))},y=function(t){Object(o.a)(n,t);var e=s(n);function n(){return Object(l.a)(this,n),e.apply(this,arguments)}return Object(i.a)(n,[{key:\"unflattenTree\",value:function(t){function e(t,e){var n=t.position,r=e.position,i=0;return n>r?i=1:n<r&&(i=-1),i}return function(t){for(var n,r,i=[],o={},a=0,c=t.length;a<c;a++)o[(n=t[a]).id]=n,o[n.id].children=[];for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&((r=o[l]).parentId?o[r.parentId]&&(o[r.parentId].children.push(r),o[r.parentId].children.sort(e)):(i.push(r),i.sort(e)));return i}(t)}}]),n}(h),v=function(t){Object(o.a)(n,t);var e=s(n);function n(t,r,i){var o;Object(l.a)(this,n),o=e.call(this,t);var a=JSON.stringify(o.directoryCopy);o.orphanedFiles=[];var c,u=f(r);try{var s=function(){var t=c.value;if(!a.includes(t.fileId)){t.id=t.fileId;var e=i.find((function(e){return e.id===t.schemaId}));t.isLeaf=e.metadata.isLeaf,o.orphanedFiles.push(t)}};for(u.s();!(c=u.n()).done;)s()}catch(t){u.e(t)}finally{u.f()}return o}return n}(h),m=function(t){Object(o.a)(n,t);var e=s(n);function n(){return Object(l.a)(this,n),e.apply(this,arguments)}return Object(i.a)(n,[{key:\"changeVisibility\",value:function(t){var e=this.directoryCopy.find((function(e){return e.id===t}));e.isVisible=!e.isVisible}},{key:\"changeName\",value:function(t,e){var n,r=f(this.directoryCopy.filter((function(e){return e.fileId===t})));try{for(r.s();!(n=r.n()).done;){n.value.label=e}}catch(t){r.e(t)}finally{r.f()}}}]),n}(h),b=function(t){Object(o.a)(n,t);var e=s(n);function n(){return Object(l.a)(this,n),e.apply(this,arguments)}return Object(i.a)(n,[{key:\"getParentOfEntity\",value:function(t){if(t.parentId)return this.directoryCopy.find((function(e){return e.id===t.parentId}));var e=this.directoryCopy.find((function(e){return e.id===t.id}));return this.directoryCopy.find((function(t){return t.id===e.parentId}))}},{key:\"getAllParentsToFile\",value:function(t){var e,n=this,r=[],i=f(this.directoryCopy.filter((function(e){return e.fileId===t})));try{for(i.s();!(e=i.n()).done;){var o=e.value;r.push(o.parentId)}}catch(t){i.e(t)}finally{i.f()}var a=[];if(r.length>0){var c,l=f(r);try{var u=function(){var t=c.value,e=n.directoryCopy.find((function(e){return e.id===t}));e&&a.push(e.id)};for(l.s();!(c=l.n()).done;)u()}catch(t){l.e(t)}finally{l.f()}}return a}}]),n}(h),I=function(t){Object(o.a)(n,t);var e=s(n);function n(){return Object(l.a)(this,n),e.apply(this,arguments)}return Object(i.a)(n,[{key:\"moveDown\",value:function(t){var e=this.directoryCopy.find((function(e){return e.id===t})),n=this.directoryCopy.find((function(t){return t.parentId===e.parentId&&t.position===e.position+1}));n&&(e.position=e.position+1,n.position=n.position-1)}},{key:\"moveUp\",value:function(t){var e=this.directoryCopy.find((function(e){return e.id===t})),n=this.directoryCopy.find((function(t){return t.parentId===e.parentId&&t.position===e.position-1}));n&&(e.position=e.position-1,n.position=n.position+1)}}]),n}(h),O=function(t){Object(o.a)(n,t);var e=s(n);function n(t,r){var i;return Object(l.a)(this,n),(i=e.call(this,t)).arrayWithDeletedEntity=i.directoryCopy.filter((function(t){return t.id!==r})),i}return n}(h);var j=function(t){Object(o.a)(n,t);var e=s(n);function n(t){var r;return Object(l.a)(this,n),(r=e.call(this,t)).flatDirectoryWithoutLeaves=r.directoryCopy.filter((function(t){return!1===t.isLeaf})),r}return Object(i.a)(n,[{key:\"unflattenLeavelessTree\",value:function(t){return t?this.unflattenTree(t):this.unflattenTree(this.flatDirectoryWithoutLeaves)}},{key:\"removeEntityByFileId\",value:function(t){return this.flatDirectoryWithoutLeaves.filter((function(e){return e.fileId!==t}))}}]),n}(y),g=function(t){Object(o.a)(n,t);var e=s(n);function n(t,r,i){var o;if(Object(l.a)(this,n),o=e.call(this,t),!r.isLeaf&&o.directoryCopy.some((function(t){return t.fileId===r.fileId}))){o.directoryCopy.find((function(t){return t.fileId===r.fileId})).parentId=i[0]}else{var a=o.directoryCopy.filter((function(t){return i.includes(t.parentId)||t.fileId!==r.fileId})),c=a.filter((function(t){return t.fileId===r.fileId})),s=[];if(c){var d,p=f(c);try{for(p.s();!(d=p.n()).done;){var h=d.value;s.push(h.parentId)}}catch(t){p.e(t)}finally{p.f()}}var y=function(t,e){for(var n=[],r=[],i=0;i<t.length;i++)n[t[i]]=!0;for(var o=0;o<e.length;o++)n[e[o]]?delete n[e[o]]:n[e[o]]=!0;for(var a in n)r.push(a);return r}(s,i);if(y){var v,m=f(y);try{var b=function(){var t=v.value,e=JSON.parse(JSON.stringify(r));e.parentId=t,e.isVisible=!1;var n=a.filter((function(e){return e.parentId===t}));if(n.length>0){var i=Math.max.apply(Math,n.map((function(t){return t.position})));e.position=i+1}else e.position=1;e.id=Object(u.a)(),a.push(e)};for(m.s();!(v=m.n()).done;)b()}catch(t){m.e(t)}finally{m.f()}}o.directoryCopy=a}return o}return n}(h),w=function(t){Object(o.a)(n,t);var e=s(n);function n(){return Object(l.a)(this,n),e.apply(this,arguments)}return Object(i.a)(n,[{key:\"inEntity\",value:function(t){var e,n=1,r=f(this.directoryCopy.filter((function(e){return e.parentId===t})));try{for(r.s();!(e=r.n()).done;){e.value.position=n,n+=1}}catch(t){r.e(t)}finally{r.f()}return this.directoryCopy}}]),n}(h);var C=function(t){Object(o.a)(n,t);var e=s(n);function n(t,i,o){var a;Object(l.a)(this,n);var c,u=[],s=f((a=e.call(this,t)).directoryCopy);try{for(s.s();!(c=s.n()).done;){var d=c.value;i.includes(d.schemaId)&&d.fileId!==o&&u.push(d)}}catch(t){s.e(t)}finally{s.f()}if(u.length>0){var p=function t(e,n){var r,i=[],o=f(e);try{var a=function(){var t=r.value;if(!i.some((function(e){return e.id===t.id}))){var e,o=f(n);try{for(o.s();!(e=o.n()).done;){var a=e.value;\"0\"===a.parentId.toString()||t.id!==a.parentId||i.includes(t)||i.push(t)}}catch(t){o.e(t)}finally{o.f()}}};for(o.s();!(r=o.n()).done;)a()}catch(t){o.e(t)}finally{o.f()}var c=[];return i.length>0&&(c=t(e,i)),i.concat(c)}(a.directoryCopy,u),h=Object(r.a)(new Set(p));a.result=u.concat(h)}else a.result=u;return a}return n}(h)},411:function(t,e,n){var r=n(476);\"string\"==typeof r&&(r=[[t.i,r,\"\"]]),r.locals&&(t.exports=r.locals);(0,n(21).default)(\"50290ed2\",r,!0,{sourceMap:!1})},475:function(t,e,n){\"use strict\";n(411)},476:function(t,e,n){var r=n(20)(!1);r.push([t.i,\".position{color:#fff;width:30px}\",\"\"]),t.exports=r},482:function(t,e,n){\"use strict\";n.r(e);n(56),n(99),n(47),n(66);var r=n(3),i=n(532),o=n(65),a=n(400);function c(t,e){var n;if(\"undefined\"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if(\"string\"==typeof t)return l(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);\"Object\"===n&&t.constructor&&(n=t.constructor.name);if(\"Map\"===n||\"Set\"===n)return Array.from(t);if(\"Arguments\"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(t,e)}(t))||e&&t&&\"number\"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}var o,a=!0,c=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){c=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(c)throw o}}}}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function u(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function s(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?u(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var f={props:{elementId:{type:String,required:!0},name:{type:String,required:!0},label:{type:String,required:!0},hasError:{type:Boolean,default:!1}},data:function(){return{relationshipsArray:[],directoryWithOnlyAllowedEntitiesAndParents:[]}},computed:s(s({},Object(o.b)({fileValues:\"file/getFileValues\",schemaElements:\"schema/getSchemaElements\",relationships:\"relationship/getRelationships\",storeDirestory:\"directory/getDirectory\"})),{},{watchRelationships:function(){return this.relationships},relationshipsWithoutOwnFileId:function(){var t=this;return this.relationshipsArray.filter((function(e){return e.fileId!==t.fileValues.id}))}}),watch:{watchRelationships:{deep:!0,handler:function(){this.findData()}}},mounted:function(){this.findData()},methods:{findData:function(){var t,e=this,n=c(this.relationships);try{var r=function(){var n=t.value,r=e.storeDirestory.find((function(t){return t.fileId===n.fileId}));r&&(n.label=r.label,n.isLeaf=r.isLeaf)};for(n.s();!(t=n.n()).done;)r()}catch(t){n.e(t)}finally{n.f()}this.relationshipsArray=JSON.parse(JSON.stringify(this.relationships.filter((function(t){return t.elementId===e.elementId})))),this.filterDirectory()},filterDirectory:function(){var t,e=this,n=c(this.schemaElements);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.elementId===this.elementId){var i,o=new a.c(this.storeDirestory,r.parameters.selectedSchemaIds,this.fileValues.id),l=c(o.result);try{var u=function(){var t=i.value;r.parameters.selectedSchemaIds.includes(t.schemaId)||(t.locked=!0),e.relationships.some((function(e){return e.fileId===t.fileId}))&&(t.checked=!0)};for(l.s();!(i=l.n()).done;)u()}catch(t){l.e(t)}finally{l.f()}var s=new a.h(o.result);this.directoryWithOnlyAllowedEntitiesAndParents=s.unflattenTree(s.directoryCopy)}}}catch(t){n.e(t)}finally{n.f()}},updatePosition:function(t){this.$store.commit(\"relationship/updateElementInRelationships\",t)},addRelationship:function(t){var e=Object(i.a)(),n=[{relationshipId:e,fileId:this.fileValues.id,position:null,elementId:this.elementId},{relationshipId:e,fileId:t.fileId,position:null,elementId:this.elementId}];this.$store.commit(\"relationship/addRelationships\",n)},removeRelationship:function(t){var e,n=c(this.relationships);try{for(n.s();!(e=n.n()).done;){var r=e.value;r.fileId===t.fileId&&this.$store.commit(\"relationship/deleteRelationships\",r.relationshipId)}}catch(t){n.e(t)}finally{n.f()}}}},d=(n(475),n(55)),p=n(67),h=n.n(p),y=n(385),v=n(567),m=n(545),b=n(399),I=n(569),O=n(547),j=n(596),g=Object(d.a)(f,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n(\"div\",[n(\"v-list\",{attrs:{dense:\"\"}},[n(\"v-list-item-group\",t._l(t.relationshipsWithoutOwnFileId,(function(e,r){return n(\"v-list-item\",{key:r},[n(\"v-list-item-icon\",[e.isLeaf?n(\"v-icon\",[t._v(\"\\n\\t\\t\\t\\t\\t\\tmdi-file\\n\\t\\t\\t\\t\\t\")]):n(\"v-icon\",[t._v(\"\\n\\t\\t\\t\\t\\t\\tmdi-folder\\n\\t\\t\\t\\t\\t\")])],1),t._v(\" \"),n(\"v-list-item-content\",[n(\"v-list-item-title\",{domProps:{textContent:t._s(e.label)}})],1),t._v(\" \"),n(\"v-list-item-content\",[n(\"input\",{directives:[{name:\"model\",rawName:\"v-model\",value:e.position,expression:\"item.position\"}],staticClass:\"position\",domProps:{value:e.position},on:{input:[function(n){n.target.composing||t.$set(e,\"position\",n.target.value)},function(n){return t.updatePosition(e)}]}})]),t._v(\" \"),n(\"v-list-item-icon\",[n(\"v-icon\",{on:{click:function(n){return t.removeRelationship(e)}}},[t._v(\"\\n\\t\\t\\t\\t\\t\\tmdi-delete\\n\\t\\t\\t\\t\\t\")])],1)],1)})),1)],1),t._v(\" \"),n(\"div\",[n(\"v-treeview\",{attrs:{dense:\"\",items:t.directoryWithOnlyAllowedEntitiesAndParents},scopedSlots:t._u([{key:\"prepend\",fn:function(e){var r=e.item;return[r.locked?t._e():n(\"div\",[r.checked?n(\"v-icon\",{attrs:{color:\"blue\"},on:{click:function(e){return t.removeRelationship(r)}}},[t._v(\"\\n\\t\\t\\t\\t\\t\\tmdi-check-circle\\n\\t\\t\\t\\t\\t\")]):n(\"v-icon\",{on:{click:function(e){return t.addRelationship(r)}}},[t._v(\"\\n\\t\\t\\t\\t\\t\\tmdi-checkbox-blank-circle-outline\\n\\t\\t\\t\\t\\t\")])],1)]}},{key:\"label\",fn:function(e){var r=e.item;return[r.label?n(\"div\",{staticClass:\"entity_label\"},[t._v(\"\\n\\t\\t\\t\\t\\t\"+t._s(r.label)+\"\\n\\t\\t\\t\\t\")]):t._e()]}}])})],1),t._v(\" \"),n(\"br\")],1)}),[],!1,null,null,null);e.default=g.exports;h()(g,{VIcon:y.a,VList:v.a,VListItem:m.a,VListItemContent:b.a,VListItemGroup:I.a,VListItemIcon:O.a,VListItemTitle:b.b,VTreeview:j.a})}}]);","extractedComments":[]}